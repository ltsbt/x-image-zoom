let t=null,s=null,o=2,n=300,i=null;const a=50,c=window.innerWidth,u=1,d=10,w=50;function y(){t||(t=document.createElement("canvas"),t.width=n,t.height=n,t.style.position="fixed",t.style.pointerEvents="none",t.style.borderRadius=w+"%",t.style.boxShadow="0 0 10px 5px rgba(0, 0, 0, 0.5)",document.body.appendChild(t),s=t.getContext("2d"))}function x(){t&&(document.body.removeChild(t),t.remove(),t=null,s=null)}document.addEventListener("mousedown",e=>{!e.shiftKey||e.button!==0||e.target instanceof HTMLImageElement&&(window.location.hostname==="twitter.com"&&document.styleSheets[0].insertRule("img { cursor: none; }",0),e.preventDefault(),e.stopImmediatePropagation(),i=e.target,y(),r(e))},{capture:!0,passive:!1});document.addEventListener("mouseup",e=>{t&&x(),window.location.hostname==="twitter.com"&&document.styleSheets[0].deleteRule(0),i=null});document.addEventListener("mousemove",e=>{t&&r(e)});document.addEventListener("wheel",e=>{!t||!i||(e.preventDefault(),e.ctrlKey?(n+=e.deltaY*-.1,n<a&&(n=a),n>c&&(n=c),r(e)):(o+=e.deltaY*-.005,o<u&&(o=u),o>d&&(o=d),r(e)))},{passive:!1});function r(e){if(!t||!s||!i)return;const l=i.getBoundingClientRect(),m=e.clientX-l.left,f=e.clientY-l.top,h=m/l.width*i.naturalWidth-n/(2*o),v=f/l.height*i.naturalHeight-n/(2*o),p=n/o,g=n/o;t.width=n,t.height=n,t.style.left=`${e.clientX-n/2}px`,t.style.top=`${e.clientY-n/2}px`,s.clearRect(0,0,n,n),s.drawImage(i,h,v,p,g,0,0,n,n)}
